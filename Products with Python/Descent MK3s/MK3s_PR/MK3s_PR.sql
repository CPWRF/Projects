SELECT
    -- ItemNameType,
    -- f1.SerialNumber,
    -- f1.tDateTime,
    -- f1.Station,
    -- f1.StationID,
    COUNT(DISTINCT(SO))
FROM ate_db_tblfinal_new.dbo.TblFinal f1
JOIN [dbo].[TblFinal2] f2 on f1.SerialNumber = f2.SerialNumber and f1.tDateTime = f2.tDateTime
and ItemNameType in ('18195', '18191', '18205', '18213', '18213')
where f1.SO in (
16603157,
16603158,
16603160,
16603162,
16603164,
16603166,
16603167,
16603168,
16603169,
16603171,
16603172,
16603173,
16603174,
16603176,
16603177,
16603178,
16603179,
16603181,
16603183,
16603185,
16603187,
16603189,
16603190,
16603191,
16603192,
16603193,
16603194,
16603196,
16603198,
16603200,
16603202,
16603204,
16603206,
16603207,
16603208,
16603209,
16603210,
16603211,
16603213,
16603215,
16603217,
16603219,
16603221,
16603222,
16603223,
16603224,
16603225,
16603226,
16603862,
16612077,
16612078,
16612079,
16650189
)
and f1.tDateTime > '2023-10-01'